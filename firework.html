<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fireworks</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet" />
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow-x: hidden;
            box-sizing: border-box;
        }
        * {
            box-sizing: border-box;
        }
        canvas {
            position: absolute;
            top: 0;
            left: 0;
        }
        .button-container {
            display: none;
            background-color: #acacac00;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
            width: 100%;
            max-width: 500px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
        }
        .container {
            background-color: #fff;
            padding: 20px;
            text-align: center;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            border: 2px solid #000000;
            border-radius: 10px;
            margin-bottom: 10px;
            line-height: 1.8;
            font-weight: bold;
            box-shadow: 0 0 20px rgba(255,255,255,0.5);
        }
        #line1, #line2, #line3, #line4 {
            margin: 10px 0;
            font-size: 1.5rem;
        }
    </style>
</head>
<body>
    <canvas id="cas"></canvas>
    <div class="button-container">
        <div class="container">
            <p id="line1"></p>
            <p id="line2"></p>
            <p id="line3"></p>
            <p id="line4"></p>
        </div>
    </div>

    <script>
        const canvas = document.getElementById("cas");
        const ctx = canvas.getContext("2d");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const fireworkSound = new Audio('fireworks.mp3');
        function safePlaySound() {
            try { fireworkSound.play(); } catch(e) { /* kh√¥ng t√¨m th·∫•y file */ }
        }

        let bigbooms = [];
        let lastTime = new Date();

        function getRandom(min, max) {
            return Math.random() * (max - min) + min;
        }

        class Frag {
            constructor(x, y, r, color, targetX, targetY) {
                this.x = x;
                this.y = y;
                this.r = r;          // b√°n k√≠nh m·∫£nh
                this.color = color;
                this.targetX = targetX;
                this.targetY = targetY;
                this.dead = false;
            }
            moveTo() {
                this.x += (this.targetX - this.x) * 0.05;
                this.y += (this.targetY - this.y) * 0.05;
                if (Math.abs(this.targetX - this.x) < 1 && Math.abs(this.targetY - this.y) < 1) {
                    this.dead = true;
                }
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.r, 0, 2 * Math.PI);
                ctx.fillStyle = `rgb(${this.color.a}, ${this.color.b}, ${this.color.c})`;
                ctx.fill();
            }
        }

        class Boom {
            constructor(x, r, c, boomArea) {
                this.booms = [];
                this.x = x;
                this.y = canvas.height + r;
                this.r = r;
                this.c = c;
                this.boomArea = boomArea;
                this.dead = false;
                this.ba = parseInt(getRandom(80, 200));
            }
            _paint() {
                ctx.save();
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.r, 0, 2 * Math.PI); 
                ctx.fillStyle = this.c;
                ctx.fill();
                ctx.restore();
            }
            _drawLight() {
                ctx.save();
                ctx.fillStyle = "rgba(255, 228, 150, 0.3)";
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.r + 3 * Math.random() + 1, 0, 2 * Math.PI);
                ctx.fill();
                ctx.restore();
            }
            _move() {
                const dx = this.boomArea.x - this.x;
                const dy = this.boomArea.y - this.y;
                this.x += dx * 0.01;
                this.y += dy * 0.01;
                if (Math.abs(dx) <= this.ba && Math.abs(dy) <= this.ba) {
                    this._boom();
                    this.dead = true;
                } else {
                    this._paint();
                }
            }
            _boom() {
                safePlaySound();

                const fragNum = getRandom(30, 200);
                const fanwei = parseInt(getRandom(300, 400));
                for (let i = 0; i < fragNum; i++) {
                    const color = {
                        a: parseInt(getRandom(0, 255)),
                        b: parseInt(getRandom(0, 255)),
                        c: parseInt(getRandom(0, 255))
                    };
                    const angle = getRandom(-Math.PI, Math.PI);
                    const x = getRandom(0, fanwei) * Math.cos(angle) + this.x;
                    const y = getRandom(0, fanwei) * Math.sin(angle) + this.y;
                    const radius = getRandom(0, 2);
                    const frag = new Frag(this.x, this.y, radius, color, x, y); // s·ª≠a Grag -> Frag
                    this.booms.push(frag); 
                }
            }
        }

        function animate() {
            ctx.save();
            ctx.fillStyle = "rgba(0, 5, 24, 0.1)";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.restore();

            const newTime = new Date();
            if (newTime - lastTime > 1000 + (window.innerHeight - 767) / 2) {
                const random = Math.random() * 100 > 33;
                const x = getRandom(canvas.width / 5, canvas.width * 4 / 5);
                const y = getRandom(50, 200);
                if (random) {
                    const bigboom = new Boom(
                        getRandom(canvas.width / 3, canvas.width * 2 / 3),
                        2,
                        "#FFF",
                        { x, y }
                    );
                    bigbooms.push(bigboom);
                } else {
                    const bigboom = new Boom(
                        getRandom(canvas.width / 3, canvas.width * 2 / 3),
                        2,
                        "#FFF",
                        { x: canvas.width / 2, y: 200 }
                    );
                    bigbooms.push(bigboom);
                }
                lastTime = newTime;
            }

            for (let i = bigbooms.length - 1; i >= 0; i--) {
                const boom = bigbooms[i];
                if (!boom.dead) {
                    boom._move();
                    boom._drawLight();
                } else {
                    for (let j = boom.booms.length - 1; j >= 0; j--) {
                        const frag = boom.booms[j];
                        if (!frag.dead) {
                            frag.moveTo();
                        } else {
                            boom.booms.splice(j, 1);
                        }
                    }
                    if (boom.booms.length === 0) {
                        bigbooms.splice(i, 1);
                    }
                }
            }

            requestAnimationFrame(animate);
        }

        function initAnimate() {
            lastTime = new Date();
            setTimeout(() => {
                window.startTime = new Date().getTime();
                window.fadeIn = true;
            }, 3000);
            animate();
        }
        initAnimate();

        canvas.onclick = function (event) {
            const x = event.clientX;
            const y = event.clientY;
            const bigboom = new Boom(
                getRandom(canvas.width / 3, canvas.width * 2 / 3),
                2,
                "#FFF",
                { x, y }
            );
            bigbooms.push(bigboom);
        };

        window.onload = function () {
            document.querySelector('.button-container').style.display = 'block';
            showText();
        };

        function showText() {
            setTimeout(function () {
                typeText('line1', 'üéÜ NƒÉm m·ªõi 2026 ƒë·∫øn, ch√∫c b·∫°n Y·∫øn cung xin kh·ªânh c√≥ s·ª©c kho·∫ª d·ªìi d√†o üí™ v√† nƒÉng l∆∞·ª£ng t√≠ch c·ª±c m·ªói ng√†y.‚ù§Ô∏è‚Äçüî•', 70, function () {
                    setTimeout(function() {
                        typeText('line2', 'üòä Mong cho ni·ªÅm vui üé∂, ti·∫øng c∆∞·ªùi üòÇ v√† h·∫°nh ph√∫c ‚ù§Ô∏è s·∫Ω lu√¥n t√¨m ƒë·∫øn Y·∫øn.', 70, function () {
                            setTimeout(function() {
                                typeText('line3', 'üå∏ Lu√¥n lu√¥n ƒë·∫°t ƒë∆∞·ª£c ƒëi·ªÅu m√¨nh mu·ªën üèÜ V√† h√£y ti·∫øp t·ª•c c∆∞·ªùi nhi·ªÅu h∆°n nh√©, Y·∫øn c∆∞·ªùi d·ªÖ th∆∞∆°ng l·∫Øm h·∫π h·∫π ü•∞', 70, function () {
                                    setTimeout(function() {
                                        typeText('line4', 'üéäüéâ Ch√∫c m·ª´ng nƒÉm m·ªõi b·∫°n @yenmachboduong üéâüéä', 70, function () {
                                        });
                                    }, 500);
                                });
                            }, 500);
                        });
                    }, 500);
                });
            }, 1000);
        }

        function typeText(elementId, text, speed, callback) {
            const element = document.getElementById(elementId);
            if (!element) return;
            let i = 0;
            element.innerHTML = '';
            const interval = setInterval(function() {
                element.innerHTML += text.charAt(i);
                i++;
                if (i >= text.length) {
                    clearInterval(interval);
                    if (callback) callback();
                }
            }, speed);
        }

        window.addEventListener('resize', function() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    </script>
</body>
</html>