<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy New Year 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            background: black;
        }
        canvas {
            position: absolute;
            top: 0;
            left: 0;
        }
        /* N√∫t b·∫Øt ƒë·∫ßu */
        .start-button-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 20;
        }
        #startBtn {
            padding: 20px 50px;
            font-size: 2rem;
            font-weight: bold;
            font-family: 'Montserrat', sans-serif;
            background: #ff4d4d;
            color: white;
            border: none;
            border-radius: 60px;
            cursor: pointer;
            box-shadow: 0 0 30px rgba(255, 77, 77, 0.8);
            transition: 0.3s;
            letter-spacing: 2px;
        }
        #startBtn:hover {
            background: #ff1a1a;
            transform: scale(1.1);
            box-shadow: 0 0 50px rgba(255, 26, 26, 0.9);
        }
        /* Khung ch√∫c T·∫øt (·∫©n ban ƒë·∫ßu) */
        .button-container {
            display: none;
            background-color: #acacac00;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            width: 100%;
            max-width: 500px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
        }
        .container {
            background-color: #fff;
            padding: 20px;
            text-align: center;
            font-family: 'Segoe UI', sans-serif;
            border: 2px solid #000000;
            border-radius: 10px;
            line-height: 1.8;
            font-weight: bold;
            box-shadow: 0 0 20px rgba(255,255,255,0.5);
        }
        #line1, #line2, #line3, #line4 {
            margin: 10px 0;
            font-size: 1.5rem;
        }
    </style>
</head>
<body>
    <canvas id="cas"></canvas>

    <!-- N√∫t b·∫Øt ƒë·∫ßu -->
    <div class="start-button-container" id="startButtonContainer">
        <button id="startBtn">B·∫Øt ƒë·∫ßu</button>
    </div>

    <!-- Khung ch√∫c T·∫øt (·∫©n) -->
    <div class="button-container" id="fireworkText">
        <div class="container">
            <p id="line1"></p>
            <p id="line2"></p>
            <p id="line3"></p>
            <p id="line4"></p>
        </div>
    </div>

    <script>
        // --- Kh·ªüi t·∫°o canvas chung ---
        const canvas = document.getElementById("cas");
        const ctx = canvas.getContext("2d");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        // --- Bi·∫øn tr·∫°ng th√°i ---
        let started = false;            // ƒë√£ b·∫Øt ƒë·∫ßu ch∆∞a?
        let isFirstPage = true;         // ƒëang ·ªü trang ch·ªØ Happy New Year?
        let startTime = null;           // th·ªùi ƒëi·ªÉm b·∫Øt ƒë·∫ßu (ms)

        // --- Nh·∫°c n·ªÅn (ph√°t ngay sau khi b·∫Øt ƒë·∫ßu) ---
        const backgroundMusic = new Audio('fireworks.mp3');
        backgroundMusic.loop = true;

        // --- Bi·∫øn to√†n c·ª•c cho ph√°o hoa ---
        let bigbooms = [];
        let lastTime = new Date();

        // H√†m random
        function getRandom(min, max) {
            return Math.random() * (max - min) + min;
        }

        // --- L·ªõp Frag v√† Boom (ph√°o hoa) ---
        class Frag {
            constructor(x, y, r, color, targetX, targetY) {
                this.x = x; this.y = y; this.r = r;
                this.color = color;
                this.targetX = targetX; this.targetY = targetY;
                this.dead = false;
            }
            moveTo() {
                this.x += (this.targetX - this.x) * 0.05;
                this.y += (this.targetY - this.y) * 0.05;
                if (Math.abs(this.targetX - this.x) < 1 && Math.abs(this.targetY - this.y) < 1) this.dead = true;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.r, 0, 2 * Math.PI);
                ctx.fillStyle = `rgb(${this.color.a}, ${this.color.b}, ${this.color.c})`;
                ctx.fill();
            }
        }

        class Boom {
            constructor(x, r, c, boomArea) {
                this.booms = [];
                this.x = x;
                this.y = canvas.height + r;
                this.r = r;
                this.c = c;
                this.boomArea = boomArea;
                this.dead = false;
                this.ba = parseInt(getRandom(80, 200));
            }
            _paint() {
                ctx.save();
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.r, 0, 2 * Math.PI);
                ctx.fillStyle = this.c;
                ctx.fill();
                ctx.restore();
            }
            _drawLight() {
                ctx.save();
                ctx.fillStyle = "rgba(255, 228, 150, 0.3)";
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.r + 3 * Math.random() + 1, 0, 2 * Math.PI);
                ctx.fill();
                ctx.restore();
            }
            _move() {
                const dx = this.boomArea.x - this.x;
                const dy = this.boomArea.y - this.y;
                this.x += dx * 0.01;
                this.y += dy * 0.01;
                if (Math.abs(dx) <= this.ba && Math.abs(dy) <= this.ba) {
                    this._boom();
                    this.dead = true;
                } else {
                    this._paint();
                }
            }
            _boom() {
                // ƒê√£ lo·∫°i b·ªè √¢m thanh n·ªï - ch·ªâ gi·ªØ l·∫°i hi·ªáu ·ª©ng h√¨nh ·∫£nh
                const fragNum = getRandom(30, 200);
                const fanwei = parseInt(getRandom(300, 400));
                for (let i = 0; i < fragNum; i++) {
                    const color = {
                        a: parseInt(getRandom(0, 255)),
                        b: parseInt(getRandom(0, 255)),
                        c: parseInt(getRandom(0, 255))
                    };
                    const angle = getRandom(-Math.PI, Math.PI);
                    const x = getRandom(0, fanwei) * Math.cos(angle) + this.x;
                    const y = getRandom(0, fanwei) * Math.sin(angle) + this.y;
                    const radius = getRandom(0, 2);
                    const frag = new Frag(this.x, this.y, radius, color, x, y);
                    this.booms.push(frag);
                }
            }
        }

        // --- Animation ph√°o hoa n·ªÅn ---
        function animate() {
            if (!started) {
                requestAnimationFrame(animate);
                return;
            }

            ctx.save();
            ctx.fillStyle = "rgba(0, 5, 24, 0.1)";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.restore();

            const newTime = new Date();
            if (newTime - lastTime > 1000 + (window.innerHeight - 767) / 2) {
                const random = Math.random() * 100 > 33;
                const x = getRandom(canvas.width / 5, canvas.width * 4 / 5);
                const y = getRandom(50, 200);
                if (random) {
                    bigbooms.push(new Boom(
                        getRandom(canvas.width / 3, canvas.width * 2 / 3),
                        2, "#FFF", { x, y }
                    ));
                } else {
                    bigbooms.push(new Boom(
                        getRandom(canvas.width / 3, canvas.width * 2 / 3),
                        2, "#FFF", { x: canvas.width / 2, y: 200 }
                    ));
                }
                lastTime = newTime;
            }

            for (let i = bigbooms.length - 1; i >= 0; i--) {
                const boom = bigbooms[i];
                if (!boom.dead) {
                    boom._move();
                    boom._drawLight();
                } else {
                    for (let j = boom.booms.length - 1; j >= 0; j--) {
                        const frag = boom.booms[j];
                        if (!frag.dead) frag.moveTo();
                        else boom.booms.splice(j, 1);
                    }
                    if (boom.booms.length === 0) bigbooms.splice(i, 1);
                }
            }

            requestAnimationFrame(animate);
        }

        // --- Hi·ªáu ·ª©ng ch·ªØ "Happy New Year" (trang ƒë·∫ßu) ---
        let w = canvas.width, h = canvas.height;
        let particles = 99;
        let chars = [];
        let current = -1;
        const str = ['Happy', 'New', 'Year', '2026'];
        const duration = 5000;

        function makeChar(c) {
            const tmp = document.createElement('canvas');
            const size = tmp.width = tmp.height = w < 400 ? 200 : 300;
            const tmpCtx = tmp.getContext('2d');
            tmpCtx.font = 'bold ' + size + 'px Arial';
            tmpCtx.fillStyle = 'white';
            tmpCtx.textBaseline = 'middle';
            tmpCtx.textAlign = 'center';
            tmpCtx.fillText(c, size / 2, size / 2);
            const charData = tmpCtx.getImageData(0, 0, size, size);
            const charParticles = [];
            for (let i = 0; charParticles.length < particles; i++) {
                const x = size * Math.random();
                const y = size * Math.random();
                const offset = (parseInt(y) * size + parseInt(x)) * 4;
                if (offset < charData.data.length && charData.data[offset] > 0) {
                    charParticles.push([x - size / 2, y - size / 2]);
                }
            }
            return charParticles;
        }

        function makeChars(elapsed) {
            const actual = Math.floor(elapsed / duration) % str.length;
            if (current === actual) return;
            current = actual;
            chars = [...str[actual]].map(makeChar);
        }

        function render(t) {
            if (!started) {
                requestAnimationFrame(render);
                return;
            }
            if (isFirstPage) {
                // T√≠nh th·ªùi gian ƒë√£ tr√¥i qua k·ªÉ t·ª´ l√∫c nh·∫•n n√∫t
                const elapsed = performance.now() - startTime;
                makeChars(elapsed);
                ctx.fillStyle = '#00000010';
                ctx.fillRect(0, 0, w, h);
                chars.forEach((pts, i) => fireworkEffect(elapsed, i, pts));
            }
            requestAnimationFrame(render);
        }

        function fireworkEffect(t, i, pts) {
            t -= i * 200;
            const id = i + chars.length * Math.floor((t - (t % duration)) / duration);
            t = (t % duration) / duration;
            let dx = (i + 1) * w / (1 + chars.length);
            dx += Math.min(0.33, t) * 100 * Math.sin(id);
            let dy = h * 0.5;
            dy += Math.sin(id * 4547.411) * h * 0.1;
            if (t < 0.33) {
                rocket(dx, dy, id, t * 3);
            } else {
                explosion(pts, dx, dy, id, Math.min(1, Math.max(0, t - 0.33) * 2));
            }
        }

        function rocket(x, y, id, t) {
            ctx.fillStyle = 'white';
            let r = 2 - 2 * t + Math.pow(t, 15 * t) * 16;
            y = h - y * t;
            circle(x, y, r);
        }

        function explosion(pts, x, y, id, t) {
            const dy = t * t * t * 20;
            let r = Math.sin(id) * 1 + 3;
            r = t < 0.5 ? (t + 0.5) * t * r : r - t * r;
            pts.forEach((xy, i) => {
                if (i % 20 === 0) {
                    ctx.fillStyle = `hsl(${id * 55}, 55%, ${55 + t * Math.sin(t * 55 + i) * 45}%)`;
                }
                circle(t * xy[0] + x, h - y + t * xy[1] + dy, r);
            });
        }

        function circle(x, y, r) {
            ctx.beginPath();
            ctx.ellipse(x, y, r, r, 0, 0, Math.PI * 2);
            ctx.fill();
        }

        // --- Hi·ªáu ·ª©ng g√µ ch·ªØ T·∫øt ---
        function showText() {
            setTimeout(() => {
                typeText('line1', 'üéÜ NƒÉm m·ªõi 2026 ƒë·∫øn, ch√∫c b·∫°n Y·∫øn cung xin kh·ªânh c√≥ s·ª©c kho·∫ª d·ªìi d√†o üí™ v√† nƒÉng l∆∞·ª£ng t√≠ch c·ª±c m·ªói ng√†y ‚ù§Ô∏è‚Äçüî•.', 70, () => {
                    setTimeout(() => {
                        typeText('line2', 'üòä Mong cho ni·ªÅm vui üé∂, ti·∫øng c∆∞·ªùi üòÇ v√† h·∫°nh ph√∫c ‚ù§Ô∏è s·∫Ω lu√¥n t√¨m ƒë·∫øn Y·∫øn.', 70, () => {
                            setTimeout(() => {
                                typeText('line3', 'üå∏ Lu√¥n lu√¥n ƒë·∫°t ƒë∆∞·ª£c ƒëi·ªÅu m√¨nh mu·ªën üèÜ V√† h√£y ti·∫øp t·ª•c c∆∞·ªùi nhi·ªÅu h∆°n nh√©, Y·∫øn c∆∞·ªùi d·ªÖ th∆∞∆°ng l·∫Øm h·∫π h·∫π ü•∞', 70, () => {
                                    setTimeout(() => {
                                        typeText('line4', 'üéäüéâ Ch√∫c m·ª´ng nƒÉm m·ªõi b·∫°n @yenmachboduong üéâüéä', 70, () => {});
                                    }, 500);
                                });
                            }, 500);
                        });
                    }, 500);
                });
            }, 1000);
        }

        function typeText(elementId, text, speed, callback) {
            const el = document.getElementById(elementId);
            if (!el) return;
            let i = 0;
            el.innerHTML = '';
            const interval = setInterval(() => {
                el.innerHTML += text.charAt(i);
                i++;
                if (i >= text.length) {
                    clearInterval(interval);
                    if (callback) callback();
                }
            }, speed);
        }

        // --- X·ª≠ l√Ω n√∫t b·∫Øt ƒë·∫ßu ---
        document.getElementById('startBtn').addEventListener('click', function() {
            if (started) return;
            started = true;
            startTime = performance.now();  // ghi nh·∫≠n m·ªëc b·∫Øt ƒë·∫ßu

            // Ph√°t nh·∫°c n·ªÅn ngay l·∫≠p t·ª©c
            backgroundMusic.play().catch(e => console.log('Kh√¥ng th·ªÉ ph√°t nh·∫°c n·ªÅn:', e));

            // ·∫®n n√∫t b·∫Øt ƒë·∫ßu
            document.getElementById('startButtonContainer').style.display = 'none';

            // Reset th·ªùi gian ph√°t sinh ph√°o hoa
            lastTime = new Date();

            // B·∫Øt ƒë·∫ßu c√°c v√≤ng l·∫∑p animation
            animate();
            requestAnimationFrame(render);

            // Sau 20 gi√¢y, ·∫©n ch·ªØ Happy New Year v√† hi·ªán khung ch√∫c T·∫øt
            setTimeout(() => {
                isFirstPage = false;
                document.getElementById('fireworkText').style.display = 'block';
                showText();
            }, 20000);
        });

        // Click tr√™n canvas ƒë·ªÉ b·∫Øn th√™m ph√°o hoa (ch·ªâ khi ƒë√£ b·∫Øt ƒë·∫ßu)
        canvas.onclick = (e) => {
            if (!started) return;
            const x = e.clientX;
            const y = e.clientY;
            bigbooms.push(new Boom(
                getRandom(canvas.width/3, canvas.width*2/3),
                2, "#FFF", { x, y }
            ));
        };

        // Resize canvas
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            w = canvas.width; h = canvas.height;
        });

        // Kh√¥ng t·ª± ƒë·ªông ch·∫°y g√¨ c·∫£ (ch·ªù n√∫t b·∫Øt ƒë·∫ßu)
    </script>
</body>
</html>
